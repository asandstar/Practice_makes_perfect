	ORG 0000H
	LJMP MAIN
	ORG 0003H
	LJMP EXTERNAL_INT0

	ORG 0100H
MAIN:
	SETB EA		 ; 允许所有中断
	SETB IT0	 ;外部中断0低电平触发方式
	SETB EX0	 ; 使能外部中断0
	
MAIN_LOOP:
	MOV P1,#0FFH ; 8个灯全灭
	ACALL DELAY50MS ; 调用延时函数
	MOV P1,#00H		 ; 8个灯全亮
	ACALL DELAY50MS ; 调用延时函数
	SJMP MAIN_LOOP	 ; 跳转回主循环


EXTERNAL_INT0:	; 外部中断0处理程序
	ACALL DELAY50MS	  
	LCALL LED_FLASH  ; 调用LED_FLASH子程序	
	RETI

LED_FLASH:   ; 上下4个LED闪烁子程序
	MOV R1, #0F0H   ; 设置R1为0F0H，控制上面4个LED 
	MOV P1,R1	   ; 将R1的值写入P1口
	ACALL DELAY50MS ; 调用延时函数
	MOV R1, #0FFH   
	MOV P1,R1	   
	ACALL DELAY50MS 
	MOV R1, #0F0H   
	MOV P1,R1	   
	ACALL DELAY50MS
	MOV R1, #0FFH   
	MOV P1,R1	   
	ACALL DELAY50MS 

	MOV R1, #0FH   ; 设置R1为0FH，控制下面4个LED 
	MOV P1,R1	   ; 将R1的值写入P1口
	ACALL DELAY50MS ; 调用延时函数
	MOV R1, #0FFH   
	MOV P1,R1	   
	ACALL DELAY50MS 
	MOV R1, #0FH  
	MOV P1,R1	  
	ACALL DELAY50MS 
	MOV R1, #0FFH   
	MOV P1,R1	   
	ACALL DELAY50MS 

	RET

DELAY50MS:			;@11.0592MHz
	NOP
	NOP
	NOP
	PUSH	30H
	PUSH	31H
	PUSH	32H
	MOV		30H,#2
	MOV		31H,#175
		MOV		32H,#72
NEXT50:
	DJNZ	32H,NEXT50
	DJNZ	31H,NEXT50
	DJNZ	30H,NEXT50
	POP		32H
	POP		31H
	POP		30H
	RET

DELAY500MS:			;@11.0592MHz
	NOP
	NOP
	NOP
	PUSH 30H
	PUSH 31H
	PUSH 32H
	MOV 30H,#17
	MOV 31H,#208
	MOV 32H,#24
NEXT:	
	DJNZ 32H,NEXT
	DJNZ 31H,NEXT
	DJNZ 30H,NEXT
	POP 32H
	POP 31H
	POP 30H
	RET

	END